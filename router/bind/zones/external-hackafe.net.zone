$TTL 3600
; hackafe.net
@ IN SOA {{ salt['grains.get']('fqdn') }}. mark.hackafe.net. (
	2016053109  ; Serial
	28800      ; Refresh
	1800       ; Retry
	604800     ; Expire - 1 week
	86400 )    ; Minimum
		IN	NS	{{ salt['grains.get']('host') }}
vegafive	IN	A	192.168.0.1
cloud		IN	A	71.19.155.60
localhost	IN	A	127.0.0.1

@		IN	MX	1 aspmx.l.google.com.
@		IN	MX	5 alt1.aspmx.l.google.com.
@		IN	MX	5 alt2.aspmx.l.google.com.
@		IN	MX	10 alt3.aspmx.l.google.com.
@		IN	MX	10 alt4.aspmx.l.google.com.

@		IN	SPF	"v=spf1 include:_spf.google.com ~all"
@		IN	TXT	"v=spf1 include:_spf.google.com ~all"

calendar	IN	CNAME	ghs.googlehosted.com.
docs		IN	CNAME	ghs.googlehosted.com.
drive		IN	CNAME	ghs.googlehosted.com.
groups		IN	CNAME	ghs.googlehosted.com.
hangouts	IN	CNAME	ghs.googlehosted.com.
mail		IN	CNAME	ghs.googlehosted.com.
plus		IN	CNAME	ghs.googlehosted.com.
sheets		IN	CNAME	ghs.googlehosted.com.
sites		IN	CNAME	ghs.googlehosted.com.
slides		IN	CNAME	ghs.googlehosted.com.
start		IN	CNAME	ghs.googlehosted.com.
vault		IN	CNAME	ghs.googlehosted.com.

google._domain_key IN	TXT	"v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC/fTOEJdChhNCIWJ/BCUzqbDvOx1VhuhyftD/FgqShdzbfeEuzzVb9pYYr8QMFcs8CUABUhQRttC9j7CeFwalyXWQW1/4Cr7xcjYSTxJ4IKJJ9Cbfb0ZE+tK8Ob/WZodkKkxjimxjkdwsTzFiuli1LAwy4Uf7GA5uBsl9n/bju0wIDAQAB"

{%- set external_set = False -%}
{%- for server, ips in salt['mine.get']('*', 'network.ip_addrs').items() -%}
{%- if server not in ignore_hosts -%}
{%- for ip in ips -%}
{%- if ip.startswith('192.168') %}
{{ server|replace('.hackafe.net','') }}	IN	CNAME	hackafe.net.
{%- elif server.replace('.hackafe.net','') in salt['pillar.get']('bind:internal_servers') and not ip.startswith('169.254') and not external_set %}{% set external_set = True %}
hackafe.net	IN	A	{{ ip }}
{%- endif -%}
{%- endfor -%}
{%- endif -%}
{%- endfor -%}
